(function(e,c,a,g){var d="qTable",f={url:null,sort:false,search:false,footer_url:null,transistOut:"zoomOut",rowClick:function(h,i){},pageRows:[20,30,50,100],pgn:5};function b(i,h){this.element=i;this.$element=e(i).clone(true);this.settings=e.extend({},f,h);this.page=1;this.pages=0;this.data=[];this.dataCount=0;this.currentData=[];this.overlay=null;this.rows=this.settings.pageRows[0];this._data_parameters();this.init()}e.extend(b.prototype,{init:function(){var k=e('<div class="q-tabulated"></div>'),i=e('<div class="qtable-responsive"></div>'),l=e('<div class="qtable-hc"><label>Rows:<select></select></label></div>'),j=e('<div class="qtable-fc"><div class="qtable-pd"></div><ul class="qtable-pagination"></ul></div>');this.$element.appendTo(i);l.appendTo(k);i.appendTo(k);j.appendTo(k);k.insertAfter(e(this.element));e(this.element).remove();this.$header=l;this.$footer=j;this._header();this._body();this._actions()},_header:function(){for(var h=0;h<this.settings.pageRows.length;h++){this.$header.find("select").append('<option value="'+this.settings.pageRows[h]+'">'+this.settings.pageRows[h]+"</option>")}},_body:function(){if(!this.$element.find("thead").length){alert("Tables should have <THEAD/> tags!");return}if(!this.$element.find("tbody").length){var h=e("<tbody></tbody>");this.$element.find("thead").siblings().appendTo(h);h.insertAfter(this.$element.find("thead"))}if(this.settings.url){this._ajax()}else{this._basic()}},_ajax:function(){var h=this;e.ajax(h.settings.url,{cache:false,beforeSend:function(){h._overlayStart()},complete:function(){h._overlayStop()},data:{start:((h.page-1)*h.rows),length:h.rows},dataType:"json",error:function(){alert("Error encountered. Log this on https://github.com/angujo/qtable")},method:"get",success:function(i){h.data=i.data;h.dataCount=i.rows;h._setData()}})},_basic:function(){this._overlayStart();var h=[];this.$element.find("tbody>tr").each(function(){var i=[];e(this).find("td,th").each(function(){i.push(e(this).html())});h.push(i)});this.data=h;this.dataCount=h.length;this._setData()},_data_parameters:function(){this.settings.url=this.$element.data("url")?this.$element.data("url"):this.settings.url},_setData:function(){var l=((this.page-1)*this.rows);this.currentData=[];this.currentData=(this.settings.url?this.data:this.data.slice(l,l+this.rows));this._remove();for(var k=0;k<this.currentData.length;k++){var m=[];for(var h=0;h<this.currentData[k].length;h++){m.push("<td>"+this.currentData[k][h]+"</td>")}this.$element.find("tbody").append("<tr>"+m.join("")+"</tr>")}this._footer();this._overlayStop()},_remove:function(){this.$element.find("tbody").html("")},_footer:function(){var l=Math.ceil(this.dataCount/(this.rows<=0?1:this.rows)),m=[],k=0,j=Math.ceil(this.settings.pgn/2),n=0;j=(j%2)?j:j+1;this.page=this.page>l?l:(this.page<=0?1:this.page);if(l<=this.settings.pgn||this.page<=j){var h=l>this.settings.pgn?this.settings.pgn:l;for(n=1;n<=h;n++){m.push(n)}}else{if(this.page>=(l-(j-1))){for(n=l;n>=(l-this.settings.pgn);n--){m.push(n)}m.reverse()}else{k=this.page-(j-1);for(n=0;n<this.settings.pgn;n++){m.push(k+n)}}}this.$footer.find(".qtable-pd").html("");this.$footer.find(".qtable-pagination").html("");this.$footer.show();if(m.length>1){this.$footer.find(".qtable-pd").html("Page <b>"+this.page+"</b> of <b>"+l+"</b>");if(1<m[0]){this.$footer.find(".qtable-pagination").append('<li><a data-pg="1">|<</a></li>');this.$footer.find(".qtable-pagination").append('<li><a data-pg="'+(this.page-1)+'"><</a></li>')}for(n=0;n<m.length;n++){var i=m[n]==this.page?'class="active"':"";this.$footer.find(".qtable-pagination").append("<li "+i+'><a data-pg="'+m[n]+'">'+m[n]+"</a></li>")}if(l>m[(m.length-1)]){this.$footer.find(".qtable-pagination").append('<li><a data-pg="'+(this.page+1)+'">></a></li>');this.$footer.find(".qtable-pagination").append('<li><a data-pg="'+l+'">>|</a></li>')}}else{this.$footer.hide()}},_actions:function(){var h=this;this.$footer.on("click","li:not(.active) a",function(){h.page=e(this).data("pg");if(h.settings.url){h._ajax()}else{h._setData()}});this.$header.on("change","select",function(){h.page=1;h.rows=parseInt(e(this).val());if(h.settings.url){h._ajax()}else{h._setData()}})},_overlayStart:function(){if(!this.overlay){this.overlay=e('<div class="qtable-overlay"><span>Loading Data...</span></div>');this.overlay.prependTo(this.$element.parent())}this.overlay.css({display:"flex"})},_overlayStop:function(){if(this.overlay){this.overlay.css({display:"none"})}}});e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))}})}})(jQuery,Window,Document);