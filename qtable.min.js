(function(b){var a={},c={search:true,sort:true,rows:[10,20,50,100],pages:5,rowsCount:10,data:[],pData:false};a.header=function(h,g){var e=[],f=b("<tr></tr>");h.find("thead tr:last-child th").each(function(){if(b(this).data("qsearch")){e.push('<td><input name="'+b(this).data("qsearch")+'"/></td>')}else{e.push("<td></td>")}});if(e.length){f.append(e.join(""));f.appendTo(h.find("thead"))}};a.body=function(k,f){f=f||[];b("tbody",k).html("");for(var g=0;g<f.length;g++){var h="<tr>";for(var e=0;e<f[g].length;e++){h+="<td>"+f[g][e]+"</td>"}h+="</tr>";b("tbody",k).append(h)}};a.tableData=function(e){var f=[];b("tbody",e).find("tr").each(function(){var g=[];b(this).find("td,th").each(function(){g.push(b(this).html())});f.push(g)});return f};a.footer=function(){};a.footerControls=function(l,h,i,j){j=j||5;var g=b('<div class="qtable-fc"><div class="qtable-pd"></div><ul class="qtable-pagination"></ul></div>'),f=[],n=0,k=Math.ceil(j/2),e=0;i=i>h?h:(i<=0?1:i);if(h<=j||i<=k){j=h>j?j:h;for(e=1;e<=j;e++){f.push(e)}}else{if(i>=(h-(k-1))){for(e=h;e>=(h-j);e--){f.push(e)}f.reverse()}else{n=i-(k-1);for(e=0;e<j;e++){f.push(n+e)}}}g.find(".qtable-pd").html("Page <b>"+i+"</b> of <b>"+h+"</b>");g.find(".qtable-pagination").append("<li "+(1==f[0]?'class="hidden"':"")+'><a data-pg="1">|<</a></li>');g.find(".qtable-pagination").append("<li "+(1==f[0]?'class="hidden"':"")+'><a data-pg="'+(i-1)+'"><</a></li>');for(e=0;e<f.length;e++){var m=f[e]==i?'class="active"':"";g.find(".qtable-pagination").append("<li "+m+'><a data-pg="'+f[e]+'">'+f[e]+"</a></li>")}g.find(".qtable-pagination").append("<li "+(h==f[(f.length-1)]?'class="hidden"':"")+'><a data-pg="'+(i+1)+'">></a></li>');g.find(".qtable-pagination").append("<li "+(h==f[(f.length-1)]?'class="hidden"':"")+'><a data-pg="'+h+'">>|</a></li>');l.find(".qtable-fc").remove();g.appendTo(l);return g};a.headerControls=function(g,e){var j=b('<div class="qtable-hc"><label>Rows:<select></select></label></div>'),h="";for(var f=0;f<e.rows.length;f++){h=e.rowsCount==e.rows[f]?"selected":"";j.find("select").append('<option value="'+e.rows[f]+'" '+h+">"+e.rows[f]+"</option>")}j.prependTo(g)};a.staticLoad=function(g,i,k,m){m=m||1;var j=((m-1)*k),l=(j+k),h=g.data.slice(j,l);a.body(i.find("table"),h,k,m);var f=Math.ceil(g.data.length/k);console.log(g.data.length);a.footerControls(i,f,m,g.pages);i.off("click","li:not(.active) a").on("click","li:not(.active) a",function(n){n.preventDefault();var o=parseInt(b(this).data("pg"));a.staticLoad(g,i,k,o)}).off("change",".qtable-hc select").on("change",".qtable-hc select",function(n){n.preventDefault();a.staticLoad(g,i,parseInt(b(this).val()))})};a.query=function(g,f,e,h,i){i=i||1;h=h||e.rowsCount;g.find("table").data("qopts",JSON.stringify(e));b.ajax(f,{cache:false,beforeSend:function(){g.find(".qtable-overlay").css({display:"flex"})},complete:function(){g.find(".qtable-overlay").css({display:"none"})},data:{start:((i-1)*h),length:h},dataType:"json",error:function(){alert("Error encountered. Log this on https://github.com/angujo/qtable")},method:"get",success:function(k){var j=Math.ceil(k.rows/h);a.body(g.find("table"),k.data,h,i);a.footerControls(g,j,i,e.pages);g.off("click","li:not(.active) a").on("click","li:not(.active) a",function(l){l.preventDefault();i=parseInt(b(this).data("pg"));a.query(g,f,e,h,i)}).off("change",".qtable-hc select").on("change",".qtable-hc select",function(l){l.preventDefault();e.rowsCount=parseInt(b(this).val());a.query(g,f,e,e.rowsCount)})}})};a.dynamic=function(g,f,e){g.prepend('<div class="qtable-overlay"><span>Loading Data...</span></div>');a.query(g,f,e)};a.init=function(j,e){var g=b('<div class="q-tabulated"></div>'),k=b('<div class="qtable-responsive"></div>'),h=j.clone(true),i=a.tableData(h),f=e;h.data("qopts",JSON.stringify(f));h.appendTo(k);k.appendTo(g);a.headerControls(g,f);f.data=i;a.header(h,f);if(h.data("fetch")){a.dynamic(g,h.data("fetch"),f)}else{a.staticLoad(f,g,f.rowsCount)}if(j.closest(".q-tabulated").length){g.insertAfter(j.closest(".q-tabulated"));j.closest(".q-tabulated").remove()}else{g.insertAfter(j);j.remove()}g.off("focusout","input").on("focusout","input",function(){var m=[];b(this).closest("tr").find("input").each(function(){if(b(this).val().length){var n=b(this).closest("td").index();m.push({i:n,v:b(this).val()})}});if(h.data("fetch")){}else{if(m.length>0){var l=f;l.data=b.grep(i,function(n,o){var p=0;for(var o=0;o<m.length;o++){if(n[m[o].i].toLowerCase().indexOf(m[o].v.toLowerCase())!==-1){p++}}return p==m.length})}else{l.data=i}if(l.pData){a.staticLoad(l,g,l.rowsCount);f.pData=l.data.length!=i.length}}})};b.fn.qTable=function(e){this.filter("table").each(function(){if(typeof e!=="object"){switch(e){case"reload":break;default:if(d(e)&&"reload"){b(this).data("fetch",e)}break}e=b(this).data("qopts")?JSON.parse(b(this).data("qopts")):c}else{e=b.extend(c,e,{});if(e.rowsCount!=e.rows[0]){e.rowsCount=e.rows[0]}}a.init(b(this),e)});return this};function d(f){var e=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.?)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return e.test(f)}})(jQuery,Window,Document);